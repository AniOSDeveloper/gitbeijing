<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="shortcut icon" type="image/png" href="/gitbeijing/static/favicon.59451036.png"/><link rel="preload" href="/gitbeijing/component---src-layouts-index-js-4a948fac265b6963541e.js" as="script"/><link rel="preload" href="/gitbeijing/component---src-templates-blog-post-js-ce2aeddc2ca75c4dd933.js" as="script"/><link rel="preload" href="/gitbeijing/path---posts-simple-branching-8209c8b7d4f95db5f579.js" as="script"/><link rel="preload" href="/gitbeijing/app-46bfb77051e0bb8f5276.js" as="script"/><link rel="preload" href="/gitbeijing/commons-fbcf7ad79a754f51e85c.js" as="script"/><style type="text/css" data-styled-components="glCqXO eIIbFr gDNaot dfPUiZ ftCQtd" data-styled-components-is-local="true">/* sc-component-id: sc-bdVaJa */

.eIIbFr{background:teal;min-height:80px;line-height:80px;text-align:center;}
/* sc-component-id: sc-bwzfXH */

.gDNaot{margin:0;}
.gDNaot a{color:#fff;text-decoration:none;}
.gDNaot a:hover{color:#77f0f0;}
/* sc-component-id: sc-htpNat */

.ftCQtd{width:100%;height:70px;}
.ftCQtd nav{background:#333;min-height:70px;color:#fff;}
.ftCQtd nav a{color:#14877e;text-decoration:none;}
.ftCQtd nav a:hover{text-decoration:underline;}
.ftCQtd p{line-height:1.9;padding:40px;text-align:center;font-size:13px;}
/* sc-component-id: sc-bxivhb */

.glCqXO{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}
/* sc-component-id: sc-EHOje */

.dfPUiZ{max-width:1000px;width:100%;margin:0 auto;}
.dfPUiZ .book-content{background:#f5f5f5;}
.dfPUiZ .book-wrapper{width:1000px;padding:40px 0 60px;margin:0 auto;background:#fff;}
.dfPUiZ .contents-wrapper{background:#f5f5f5;padding:30px 0;}
.dfPUiZ .chapter-contents{width:800px;margin:0 auto;font-family:'ProximaNova','Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:300;-webkit-letter-spacing:0.3px;-moz-letter-spacing:0.3px;-ms-letter-spacing:0.3px;letter-spacing:0.3px;line-height:36px;font-size:16px;}
.dfPUiZ .chapter-contents h1{font-family:'Crete Round',Georgia,Times New Roman,serif;font-size:24px;color:#e5533c;margin-top:0;text-align:center;}
.dfPUiZ .chapter-contents h3{font-family:'Crete Round',Georgia,Times New Roman,serif;font-size:18px;color:#14877e;}
.dfPUiZ .chapter-contents a{color:#14877e;text-decoration:none;border-bottom:1px dotted #1bbfb1;}
.dfPUiZ .book-wrapper img{display:block;max-width:700px;margin:20px auto;}
.dfPUiZ .book-wrapper img[alt='certificates']{display:block;width:291px;}
.dfPUiZ:not(pre) > code[class*='language-'],.dfPUiZ pre{background:#f5f5f5;}
.dfPUiZ pre{padding:1em;margin:0.5em 0;overflow:auto;}
.dfPUiZ code[class*='language-'],.dfPUiZ pre{color:#000;text-shadow:0 1px #fff;font-size:14px;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:26px;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}
.dfPUiZ .chapter-contents pre{color:#767676;border:1px solid #dcdcdc;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word;}
.dfPUiZ .chapter-contents p > code,.dfPUiZ .chapter-contents ul > code,.dfPUiZ .chapter-contents ol > code,.dfPUiZ .chapter-contents li > code{padding-right:4px;padding-left:4px;padding-top:2px;padding-bottom:2px;background-color:#f5f5f5;color:#14877e;border-radius:4px;font-size:15px;}
</style><style id="gatsby-inlined-css">*{box-sizing:border-box}body{margin:0;-webkit-font-smoothing:antialiased}a{text-decoration:none;color:#14877e}</style></head><body><div id="___gatsby"><div class="sc-bxivhb glCqXO" data-reactroot="" data-reactid="1" data-react-checksum="1046067374"><div class="sc-bdVaJa eIIbFr" data-reactid="2"><h2 class="sc-bwzfXH gDNaot" data-reactid="3"><a href="/gitbeijing/" data-reactid="4">Git 北京</a></h2></div><div class="sc-EHOje dfPUiZ" data-reactid="5"><div class="book-wrapper" data-reactid="6"><div class="chapter-contents" data-reactid="7"><h1 data-reactid="8"></h1><div data-reactid="9"><p>今天的主角是分支，因为不介绍分支（ branch ）的概念，下面的操作是没办法介绍了。可以这样说，Git 最核心的操作对象是版本（ commit ），最核心的操作技巧就是分支。</p>
<!-- https://help.github.com/articles/branching-out/ -->
<h3>什么是分支？</h3>
<p>仓库创建后，一旦有了新 commit，默认就会放到一个分支上，名字叫 master。前面咱们一直看到的多个版本组成的一条历史线，就是 master 分支。但是一个仓库内，用户可以自己创建其他的分支，可以有多条历史线。</p>
<p>说说 master 这个名字，一般中文叫“主分支”，其实从技术底层来讲它跟其他我们自己要创建的分支没有区别，只不过它是天生的默认分支。实际工程项目中会人为的给它一个重要的使命，存放稳定代码。就像 github 公司<a href="http://scottchacon.com/2011/08/31/github-flow.html">倡导</a>的。</p>
<blockquote>
<p>master 分支上的所有代码都应该是可以部署的</p>
</blockquote>
<p>意思就是 master 分支上的代码是随时可以放到产品服务器上跑的代码。这样，如果想开发一个新功能，可以新开分支。 想象一下历史线上有很多节，每个版本就是一节。一个分支相当于一跟竹子，一节节的往上长。</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/bamboo.jpeg"></p>
<p>但是实际上在底层并不是每个分支都拷贝出自己独立的一条历史线。其实 master 本身只是一个指针，指向 master 分支上最新的一个版本。这样由于每个 commit 都可以顺藤摸瓜找到自己的前一个 commit，那么这条历史线就可以确定了。</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/master_branch.png?raw=true"></p>
<h3>创建新分支</h3>
<p>什么时候需要开一个新分支，这个后面讲各种工作流程的时候会介绍，今天先把基本操作学会。到客户端的 <code>Branches</code> 这一项</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/create.png?raw=true"></p>
<p>点击 1 处的加号，就会弹出 2 处的对话框。<code>Create a new branch off master</code> 就是来创建一个分支。在对话框中填入 <code>idea</code>，创建了 idea 分支的。所谓 <code>off master</code> 意思是“基于 master ”分支，所以此刻 idea 分支并不为空，而是拥有和 master 一样的历史。如下图，箭头所指的小对勾表示“当前分支”（ current branch ）已经自动切换到 idea 分支。</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/idea_branch.png?raw=true"></p>
<p>但是，在底层这个的实现是非常巧妙的，就是又创建一个新的 idea 指针，跟 master 指针指向同一个版本，根本没有拷贝历史线。</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/new_branch.png?raw=true"></p>
<p>如果现在我对项目做一下修改，然后 commit 了。那么移动的只是 idea 指针，master 不变。就成了这样：</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/new_branch_commit.png?raw=true"></p>
<p>现在 master 分支包含两个版本 C1 和 C2，idea 分支包含三个版本 C1，C2，C3 。</p>
<p>默认情况下这个 idea 分支只是存在于本地，如果想在远端仓库上发布这个分支，就点一下 idea 分支右侧的 <code>Publish</code> 按钮。</p>
<p>这样，到远端仓库看一下，点击下图 1 处，发现果然 2 处多了一个 idea 分支，3 处的输入框中，不但能搜索已有分支，还能创建新分支，看到了吧，很多操作在本地客户端和 github.com 上都能进行。</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/github_idea_branch.png?raw=true"></p>
<h3>切换分支</h3>
<p>到 branches 标签下，相中哪个分支了，双击一下就切换过去了。时间长了你会觉得这个也不够快，还是纯键盘操作快。敲 Cmd-B 可以打开分支切换框，输入名字回车，就切换成功了。</p>
<p>如果你在 idea 分支上有了修改但是还没有来得及 commit，这时候如果切换分支，那么 git 会替你保存这部分修改，也就是在切换到的分支上是看不到这部分修改的。但是不要担心，只要你切换回老分支，修改内容又回来了。</p>
<p>注意，每次切换分支，项目代码，术语叫工作树（ Working Tree ）是会随着变化的，在编辑器中看看就知道了。</p>
<!-- https://help.github.com/articles/why-did-my-changes-disappear-when-switching-branches/ -->
<h3>删除分支</h3>
<p>首先当前分支是不能删除的。什么意思？到客户端的 <code>Branches</code> 标签下，左侧有对勾的就是当前分支，打开右侧小箭头的下拉菜单，可以看到 <code>delete</code> 这一项是禁用的。想删除它，就先要切换到其他分支，例如 <code>master</code> 。这样就可以删除 idea 分支了，如果执行本地删除 github.com 上对应分支也会同时被删除。</p>
<p>在客户端把分支切换到 idea，现在试图去删除 master 。点开 master 分支的小箭头，发现 <code>delete</code> 一项可以点，所以点一下，但是报错了：“"master" is the repository's default branch and cannot be deleted.` 要到 github.com 上修改默认分支（ default branch 注意跟当前分支是不同的），就像这样。</p>
<p>在远端仓库，也就是 github.com 上如何切换默认分支呢？到 <code>settings</code> 下面就更改 <code>Default branch</code> 就可以了。</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/default_branch.png?raw=true"></p>
<p>如果只想删除远端分支，保留本地分支，可以在客户端中使用每个分支右侧的 <code>Unpublish</code> 这个选项。</p>
<p><img src="https://github.com/happypeter/gitbeijing/blob/master/data/posts/images/simple_branching/unpublish.png?raw=true"></p>
<h3>总结</h3>
<p>只开测试分支，调好代码 commit 了之后，如果不把代码搞到 master 分支上是没有太大意义的，这就涉及到分支合并的问题了，这个是 git 最大最强的一块功能，后面介绍。</p></div></div></div></div><footer class="sc-htpNat ftCQtd" data-reactid="10"><nav data-reactid="11"><p data-reactid="12"><!-- react-text: 13 -->有任何问题请联系<!-- /react-text --><a href="https://github.com/happypeter" data-reactid="14"> happypeter</a><!-- react-text: 15 --> ： happypeter1983@gmail.com <!-- /react-text --><br data-reactid="16"/><!-- react-text: 17 --> 所有内容基于<!-- /react-text --><!-- react-text: 18 --> <!-- /react-text --><a href="https://creativecommons.org/licenses/by/4.0/" data-reactid="19">允许商用保留署名的 CC 协议</a><!-- react-text: 20 --> <!-- /react-text --><!-- react-text: 21 -->发布<!-- /react-text --></p></nav></footer></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-46bfb77051e0bb8f5276.js","107818501498521":"component---src-templates-blog-post-js-ce2aeddc2ca75c4dd933.js","35783957827783":"component---src-pages-index-js-9134442af0953da84420.js","60335399758886":"path----557518bd178906f8d58a.js","223867669487412":"path---posts-fork-flow-ad5316a44fbb7f05efec.js","153880186811493":"path---posts-github-for-mac-bf0de962747a296905f8.js","40459310594411":"path---posts-github-in-browser-b6c133a898954d782f51.js","114745154799724":"path---posts-github-flow-3973958225d7519b2e09.js","131466296421214":"path---posts-history-0b3e1effa2f4900a8188.js","140933230050240":"path---posts-c49fade2461e42aeacc7.js","57409757979292":"path---posts-introduction-266107d549a8dd55b4a9.js","83852032897902":"path---posts-issues-9f149f196aaee02ebe34.js","89303976106042":"path---posts-merge-420b5f3241ac8e63e03b.js","76834864418224":"path---posts-more-00ac5efd151d80f3b0af.js","151811173234944":"path---posts-next-step-f4f8ad23798f312af9f6.js","31318044476635":"path---posts-pages-ed9eeef27ee1c4c26cac.js","215350522612386":"path---posts-simple-branching-8209c8b7d4f95db5f579.js","142629428675168":"path---index-d9b976edc2deca23652f.js","114276838955818":"component---src-layouts-index-js-4a948fac265b6963541e.js"}/*]]>*/</script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/gitbeijing/commons-fbcf7ad79a754f51e85c.js","/gitbeijing/app-46bfb77051e0bb8f5276.js","/gitbeijing/path---posts-simple-branching-8209c8b7d4f95db5f579.js","/gitbeijing/component---src-templates-blog-post-js-ce2aeddc2ca75c4dd933.js","/gitbeijing/component---src-layouts-index-js-4a948fac265b6963541e.js"])/*]]>*/</script></body></html>